# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Slack anomaly event
description: |-
  ## Goal

  Detect when a Slack audit anomaly event is raised.

  ## Strategy

  This rule monitors Slack audit logs for anomalies, which indicate unexpected user behaviors. Each anomalous event will have a reason code. Examples of anomalies include:

  - Excessive file downloads
  - Use of a Tor exit node
  - Unusual behavior from an administrator account

  ## Triage and response

  1. Determine if the behavior is expected by:
     - Contacting the user for more information
     - Checking for other signals and logs generated by the impacted user, and looking for deviations in geolocation, ASN, or device properties
  2. If the activity is deemed malicious:
     - Initiate your organization's incident response process and investigate.
enabled: true
severity: Low
query_text: |-
  %ingest.source_type:"slack:audit"
  service:audit-logs-service
  action:anomaly
  | groupbycount(actor.user.email)
  | where @q.count > 0
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- low_severity_alerts
tags:
- source.slack
